---
title: "SBOM & License Compliance"
description: "Software Bill of Materials generation, export, and license compliance in Artifact Keeper"
---

Artifact Keeper automatically generates Software Bill of Materials (SBOM) for uploaded artifacts, enabling supply chain transparency, license compliance, and vulnerability tracking.

## Overview

An SBOM is a comprehensive inventory of all components, libraries, and dependencies in your software. Artifact Keeper supports:

- **Automatic SBOM generation** on artifact upload
- **Multiple formats**: CycloneDX 1.5 and SPDX 2.3
- **License detection** and compliance checking
- **CVE correlation** with vulnerability databases
- **Export via REST API and gRPC**

## Supported Formats

### CycloneDX

[CycloneDX](https://cyclonedx.org/) is an OWASP standard for SBOM:

```json
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.5",
  "serialNumber": "urn:uuid:...",
  "version": 1,
  "metadata": {
    "timestamp": "2024-01-15T10:30:00Z",
    "tools": [{ "name": "artifact-keeper", "version": "1.0.0" }]
  },
  "components": [
    {
      "type": "library",
      "name": "lodash",
      "version": "4.17.21",
      "purl": "pkg:npm/lodash@4.17.21",
      "licenses": [{ "license": { "id": "MIT" } }]
    }
  ]
}
```

### SPDX

[SPDX](https://spdx.dev/) is a Linux Foundation standard:

```json
{
  "spdxVersion": "SPDX-2.3",
  "dataLicense": "CC0-1.0",
  "SPDXID": "SPDXRef-DOCUMENT",
  "name": "my-package-sbom",
  "packages": [
    {
      "SPDXID": "SPDXRef-Package-lodash",
      "name": "lodash",
      "versionInfo": "4.17.21",
      "downloadLocation": "https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz",
      "licenseConcluded": "MIT"
    }
  ]
}
```

## REST API

### Generate SBOM

Generate or regenerate an SBOM for an artifact:

```bash
POST /api/v1/sbom/generate
Content-Type: application/json

{
  "artifact_id": "uuid-of-artifact",
  "format": "cyclonedx"  // or "spdx"
}
```

### Get SBOM

Retrieve the SBOM for an artifact:

```bash
GET /api/v1/sbom/{artifact_id}?format=cyclonedx
```

Response:

```json
{
  "artifact_id": "uuid-of-artifact",
  "format": "cyclonedx",
  "generated_at": "2024-01-15T10:30:00Z",
  "component_count": 145,
  "dependency_count": 892,
  "license_count": 12,
  "content": { ... }
}
```

### Download SBOM

Download SBOM as a file:

```bash
GET /api/v1/sbom/{artifact_id}/download?format=cyclonedx
```

Returns: `application/json` file with `Content-Disposition: attachment`

### List Components

Get paginated list of SBOM components:

```bash
GET /api/v1/sbom/{artifact_id}/components?page=1&limit=50
```

## gRPC API

Artifact Keeper also provides a gRPC service for SBOM operations:

```protobuf
service SbomService {
  rpc GenerateSbom(GenerateSbomRequest) returns (SbomResponse);
  rpc GetSbom(GetSbomRequest) returns (SbomResponse);
  rpc GetComponents(GetComponentsRequest) returns (ComponentsResponse);
  rpc GetCveHistory(GetCveHistoryRequest) returns (CveHistoryResponse);
}
```

Connect to the gRPC endpoint:

```bash
# Default gRPC port
grpcurl -plaintext localhost:9090 list
grpcurl -plaintext localhost:9090 sbom.SbomService/GetSbom
```

## CVE History

Artifact Keeper tracks CVE history for each artifact, correlating SBOM components with vulnerability databases:

```bash
GET /api/v1/sbom/{artifact_id}/cves
```

Response:

```json
{
  "cves": [
    {
      "cve_id": "CVE-2021-23337",
      "severity": "HIGH",
      "cvss_score": 7.2,
      "affected_component": "lodash",
      "affected_version": "4.17.20",
      "fixed_version": "4.17.21",
      "status": "fixed",
      "first_seen": "2024-01-10T08:00:00Z",
      "resolved_at": "2024-01-12T14:30:00Z"
    }
  ],
  "summary": {
    "total": 5,
    "open": 1,
    "fixed": 3,
    "acknowledged": 1
  }
}
```

### CVE Status Values

- **open**: Vulnerability is present and unaddressed
- **fixed**: Component has been updated to a non-vulnerable version
- **acknowledged**: Vulnerability accepted as risk (with justification)
- **false_positive**: Marked as not applicable to this context

## License Compliance

### Detected Licenses

Artifact Keeper detects licenses from:

- Package metadata (package.json, Cargo.toml, pom.xml, etc.)
- LICENSE files
- SPDX license identifiers in source code
- License headers in files

### License Policies

Create policies to enforce license compliance:

```bash
POST /api/v1/sbom/license-policies
Content-Type: application/json

{
  "name": "No GPL in Production",
  "action": "block",
  "blocked_licenses": ["GPL-2.0", "GPL-3.0", "AGPL-3.0"],
  "allowed_licenses": ["MIT", "Apache-2.0", "BSD-3-Clause"],
  "repositories": ["production-*"]
}
```

### Check License Compliance

```bash
GET /api/v1/sbom/{artifact_id}/license-check
```

Response:

```json
{
  "compliant": false,
  "violations": [
    {
      "component": "gpl-library",
      "version": "1.0.0",
      "license": "GPL-3.0",
      "policy": "No GPL in Production",
      "action": "block"
    }
  ],
  "allowed": [
    { "component": "lodash", "license": "MIT" },
    { "component": "axios", "license": "MIT" }
  ]
}
```

## Dependency-Track Integration

Artifact Keeper integrates with [OWASP Dependency-Track](https://dependencytrack.org/) for advanced SBOM analysis and policy management.

### Configuration

Enable Dependency-Track in your environment:

```bash
# Required
DEPENDENCY_TRACK_URL=http://dependency-track:8080
DEPENDENCY_TRACK_API_KEY=your-api-key
DEPENDENCY_TRACK_ENABLED=true
```

### Docker Compose Setup

Dependency-Track is included in the docker-compose stack:

```yaml
services:
  dependency-track-apiserver:
    image: dependencytrack/apiserver:4.11.4
    environment:
      ALPINE_DATABASE_MODE: external
      ALPINE_DATABASE_URL: jdbc:postgresql://postgres:5432/dependency_track
      ALPINE_DATABASE_DRIVER: org.postgresql.Driver
      ALPINE_DATABASE_USERNAME: registry
      ALPINE_DATABASE_PASSWORD: registry
    ports:
      - "8092:8080"
```

To access the optional Dependency-Track UI for debugging:

```bash
docker compose --profile dtrack-ui up -d
# Access at http://localhost:8093
```

### Automatic SBOM Upload

When enabled, Artifact Keeper automatically:

1. Generates SBOM on artifact upload
2. Creates/finds a Dependency-Track project for the repository
3. Uploads the SBOM to Dependency-Track
4. Waits for vulnerability analysis to complete
5. Syncs findings back to Artifact Keeper's CVE history

### Policy Violations

Dependency-Track provides granular policy management:

- **License policies**: Block specific license types
- **Vulnerability policies**: Block by severity threshold
- **Component policies**: Block outdated or banned components
- **Operational policies**: Enforce component age limits

View policy violations:

```bash
GET /api/v1/sbom/{artifact_id}/policy-violations
```

Response:

```json
{
  "violations": [
    {
      "type": "LICENSE",
      "component": "gpl-lib",
      "version": "1.0.0",
      "policy": "No GPL Licenses",
      "condition": "LICENSE IS GPL-3.0",
      "state": "FAIL"
    },
    {
      "type": "VULNERABILITY",
      "component": "log4j",
      "version": "2.14.0",
      "policy": "Block Critical CVEs",
      "condition": "SEVERITY >= CRITICAL",
      "state": "FAIL"
    }
  ]
}
```

## UI Integration

### Web, iOS, and Android

All Artifact Keeper clients display SBOM data:

- **SBOM Tab**: View components, licenses, and dependencies
- **Format Selector**: Switch between CycloneDX and SPDX
- **Generate/Regenerate**: Trigger SBOM generation
- **Download**: Export SBOM as JSON file
- **CVE History**: View vulnerability timeline with status
- **License Compliance**: See policy violations

### Security Dashboard

The security dashboard aggregates SBOM data across repositories:

- Component count trends
- License distribution
- Vulnerability status by severity
- Policy compliance rates

## Best Practices

### SBOM Generation

- Generate SBOMs for all production artifacts
- Use CycloneDX for vulnerability tracking (better tool support)
- Use SPDX for license compliance (legal standard)
- Regenerate after dependency updates

### License Management

- Define allowed/blocked license lists early
- Use "warn" action for new policies before "block"
- Document license exceptions with justifications
- Review license policies quarterly

### Dependency-Track

- Configure Dependency-Track API key with minimal permissions
- Set up scheduled syncs for vulnerability database updates
- Use projects to organize artifacts by repository
- Enable notifications for new critical vulnerabilities

## See Also

- [Vulnerability Scanning](/docs/security/scanning) - CVE detection and scanning
- [Security Policies](/docs/security/policies) - Policy enforcement
- [Artifact Signing](/docs/security/signing) - Supply chain attestation
