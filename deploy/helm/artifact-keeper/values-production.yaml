# =============================================================================
# EXAMPLE CONFIGURATION - Getting Started Template
# =============================================================================
# This file is provided as a starting point for deployments. It should be
# reviewed and modified to match your specific infrastructure requirements,
# security policies, and operational needs before use in production.
# =============================================================================

# Production environment overlay

backend:
  replicaCount: 3
  image:
    tag: latest
  env:
    RUST_LOG: "info"
    ENVIRONMENT: "production"
    ADMIN_PASSWORD: ""
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: "4"
      memory: 4Gi
  persistence:
    size: 100Gi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilization: 60
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  serviceAccount:
    annotations:
      eks.amazonaws.com/role-arn: ""  # Set to IRSA role ARN

web:
  replicaCount: 3
  image:
    tag: latest
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: "2"
      memory: 2Gi

edge:
  enabled: true
  replicaCount: 2

# Disable in-cluster postgres â€” use RDS
postgres:
  enabled: false

externalDatabase:
  host: ""  # Set to RDS endpoint
  port: 5432
  username: artifact_keeper
  password: ""
  database: artifact_registry
  existingSecret: artifact-keeper-rds
  existingSecretKey: DATABASE_URL

meilisearch:
  masterKey: ""
  env: "production"
  persistence:
    size: 20Gi
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: "2"
      memory: 4Gi

trivy:
  persistence:
    size: 20Gi
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: "2"
      memory: 4Gi

dependencyTrack:
  adminPassword: ""
  persistence:
    size: 20Gi
  resources:
    requests:
      cpu: "1"
      memory: 4Gi
    limits:
      cpu: "4"
      memory: 8Gi

ingress:
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "1024m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  host: ""  # Set to production domain
  tls:
    enabled: true

secrets:
  jwtSecret: ""
  s3AccessKey: ""
  s3SecretKey: ""

networkPolicy:
  enabled: true

serviceMonitor:
  enabled: true
  interval: 15s
