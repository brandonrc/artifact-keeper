# =============================================================================
# Artifact Keeper — Environment Variables Reference
# =============================================================================
# All variables are read by the backend process unless noted otherwise.
# Lines starting with # are comments; uncomment to enable.

# -----------------------------------------------------------------------------
# Database (backend)
# -----------------------------------------------------------------------------
DATABASE_URL=postgres://registry:registry@localhost:5432/artifact_registry

# -----------------------------------------------------------------------------
# Server (backend)
# -----------------------------------------------------------------------------
BIND_ADDRESS=0.0.0.0:8080
LOG_LEVEL=info

# Environment (development | production)
# In development mode, CORS automatically allows requests from private-network
# IPs (192.168.x.x, 10.x.x.x, 172.16-31.x.x) and localhost — no extra config
# needed for LAN access.
ENVIRONMENT=development

# CORS allowed origins (comma-separated).
# Only required in production mode or to allow public IPs.
# In development mode this is optional — private-network origins are auto-allowed.
# CORS_ORIGINS=https://registry.example.com,https://registry-internal.example.com

# gRPC server port (backend, default: 9090)
# GRPC_PORT=9090

# -----------------------------------------------------------------------------
# Storage (backend) — choose one backend
# -----------------------------------------------------------------------------
STORAGE_BACKEND=filesystem
STORAGE_PATH=/var/lib/artifact-keeper/artifacts

# Storage path format: "native" (default), "artifactory" (JFrog-compatible),
# or "migration" (reads both formats during migration).
# STORAGE_PATH_FORMAT=native

# --- S3 Storage (when STORAGE_BACKEND=s3) ---
# S3_BUCKET=my-artifacts
# S3_REGION=us-east-1
# S3_ENDPOINT=http://localhost:9000
# S3_PREFIX=artifacts
# AWS_ACCESS_KEY_ID=minioadmin
# AWS_SECRET_ACCESS_KEY=minioadmin
# S3_REDIRECT_DOWNLOADS=false
# S3_PRESIGN_EXPIRY_SECS=3600

# S3 presigned URL credentials (optional, overrides default AWS credentials)
# S3_PRESIGN_ACCESS_KEY_ID=
# S3_PRESIGN_SECRET_ACCESS_KEY=

# CloudFront CDN (optional, for S3 backends)
# CLOUDFRONT_DISTRIBUTION_URL=https://dxxxxxxxxxx.cloudfront.net
# CLOUDFRONT_KEY_PAIR_ID=KXXXXXXXXXX
# CLOUDFRONT_PRIVATE_KEY_PATH=/path/to/cloudfront-private-key.pem
# CLOUDFRONT_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\n..."

# --- GCS Storage (when STORAGE_BACKEND=gcs) ---
# GCS_BUCKET=my-artifacts
# GCS_PROJECT_ID=my-gcp-project
# GCS_SERVICE_ACCOUNT_EMAIL=sa@project.iam.gserviceaccount.com
# GCS_PRIVATE_KEY_PATH=/path/to/service-account-key.pem
# GCS_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n..."
# GCS_REDIRECT_DOWNLOADS=true
# GCS_SIGNED_URL_EXPIRY=3600

# --- Azure Blob Storage (when STORAGE_BACKEND=azure) ---
# AZURE_STORAGE_ACCOUNT=myaccount
# AZURE_STORAGE_CONTAINER=artifacts
# AZURE_STORAGE_ACCESS_KEY=xxx
# AZURE_STORAGE_ENDPOINT=https://myaccount.blob.core.windows.net
# AZURE_REDIRECT_DOWNLOADS=false
# AZURE_SAS_EXPIRY=3600

# -----------------------------------------------------------------------------
# Authentication (backend)
# -----------------------------------------------------------------------------
JWT_SECRET=change-this-in-production-use-at-least-32-bytes
JWT_EXPIRATION_SECS=86400
# JWT_ACCESS_TOKEN_EXPIRY_MINUTES=30
# JWT_REFRESH_TOKEN_EXPIRY_DAYS=7

# Initial admin password. If unset, a random password is generated and written
# to $STORAGE_PATH/admin.password on first boot.
# ADMIN_PASSWORD=

# Set to "true" to skip the built-in admin user on first boot.
# Use this for SSO-only deployments where admin roles are assigned via
# group mapping (OIDC/LDAP/SAML). When set, no local admin account is
# created and admin access must come from an SSO provider group.
# SKIP_ADMIN_PROVISIONING=true

# SSO encryption key for encrypting stored OIDC/LDAP/SAML secrets in the database
# SSO_ENCRYPTION_KEY=

# --- OIDC (optional) ---
# OIDC_ISSUER=https://auth.example.com
# OIDC_CLIENT_ID=artifact-registry
# OIDC_CLIENT_SECRET=xxx

# --- LDAP (optional) ---
# LDAP_URL=ldap://ldap.example.com:389
# LDAP_BASE_DN=dc=example,dc=com

# -----------------------------------------------------------------------------
# Security scanning (backend)
# -----------------------------------------------------------------------------
# TRIVY_URL=http://trivy:8080
# OPENSCAP_URL=http://openscap:8080
# OPENSCAP_PROFILE=xccdf_org.ssgproject.content_profile_standard
# SCAN_WORKSPACE_PATH=/scan-workspace
# GITHUB_TOKEN=ghp_xxx

# -----------------------------------------------------------------------------
# Search indexing (backend)
# -----------------------------------------------------------------------------
# MEILISEARCH_URL=http://meilisearch:7700
# MEILISEARCH_API_KEY=masterKey

# -----------------------------------------------------------------------------
# Dependency-Track integration (backend)
# -----------------------------------------------------------------------------
# DEPENDENCY_TRACK_URL=http://dependency-track:8080
# DEPENDENCY_TRACK_API_KEY=xxx
# DEPENDENCY_TRACK_ENABLED=true

# Dependency-Track proxy (required if DTrack is behind a corporate proxy)
# Without this, NVD vulnerability mirroring will silently fail.
# Supports BASIC, DIGEST, and NTLM authentication.
# DTRACK_HTTP_PROXY_ADDRESS=proxy.example.com
# DTRACK_HTTP_PROXY_PORT=8888
# DTRACK_HTTP_PROXY_USERNAME=
# DTRACK_HTTP_PROXY_PASSWORD=
# DTRACK_NO_PROXY=localhost,127.0.0.1

# -----------------------------------------------------------------------------
# Peer mesh networking (backend)
# -----------------------------------------------------------------------------
# PEER_INSTANCE_NAME=primary
# PEER_PUBLIC_ENDPOINT=https://primary.example.com
# PEER_API_KEY=shared-peer-secret

# -----------------------------------------------------------------------------
# WASM plugins (backend)
# -----------------------------------------------------------------------------
# PLUGINS_DIR=./plugins

# -----------------------------------------------------------------------------
# OpenTelemetry (backend, disabled when OTEL_EXPORTER_OTLP_ENDPOINT is unset)
# -----------------------------------------------------------------------------
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# OTEL_SERVICE_NAME=artifact-keeper

# -----------------------------------------------------------------------------
# Demo mode (backend)
# -----------------------------------------------------------------------------
# DEMO_MODE=false

# -----------------------------------------------------------------------------
# Edge Node (for edge binary, not the main backend)
# -----------------------------------------------------------------------------
# PRIMARY_URL=https://primary.example.com
# EDGE_API_KEY=xxx
# CACHE_SIZE_MB=1024
